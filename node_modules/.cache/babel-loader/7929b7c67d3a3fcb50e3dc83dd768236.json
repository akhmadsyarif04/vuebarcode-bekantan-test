{"remainingRequest":"/srv/http/bekantan-vue-testing/node_modules/babel-loader/lib/index.js!/srv/http/bekantan-vue-testing/node_modules/eslint-loader/index.js??ref--13-0!/srv/http/bekantan-vue-testing/instascan/src/camera.js","dependencies":[{"path":"/srv/http/bekantan-vue-testing/instascan/src/camera.js","mtime":1493558896000},{"path":"/srv/http/bekantan-vue-testing/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/srv/http/bekantan-vue-testing/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/srv/http/bekantan-vue-testing/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport _getIterator from \"/srv/http/bekantan-vue-testing/node_modules/@babel/runtime-corejs2/core-js/get-iterator\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/srv/http/bekantan-vue-testing/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _createClass from \"/srv/http/bekantan-vue-testing/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _classCallCheck from \"/srv/http/bekantan-vue-testing/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"/srv/http/bekantan-vue-testing/node_modules/@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/srv/http/bekantan-vue-testing/node_modules/@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/srv/http/bekantan-vue-testing/node_modules/@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _wrapNativeSuper from \"/srv/http/bekantan-vue-testing/node_modules/@babel/runtime-corejs2/helpers/esm/wrapNativeSuper\";\nimport \"core-js/modules/es6.regexp.replace\";\n\nfunction cameraName(label) {\n  var clean = label.replace(/\\s*\\([0-9a-f]+(:[0-9a-f]+)?\\)\\s*$/, '');\n  return clean || label || null;\n}\n\nvar MediaError =\n/*#__PURE__*/\nfunction (_Error) {\n  _inherits(MediaError, _Error);\n\n  function MediaError(type) {\n    var _this;\n\n    _classCallCheck(this, MediaError);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(MediaError).call(this, \"Cannot access video stream (\".concat(type, \").\")));\n    _this.type = type;\n    return _this;\n  }\n\n  return MediaError;\n}(_wrapNativeSuper(Error));\n\nvar Camera =\n/*#__PURE__*/\nfunction () {\n  function Camera(id, name) {\n    _classCallCheck(this, Camera);\n\n    this.id = id;\n    this.name = name;\n    this._stream = null;\n  }\n\n  _createClass(Camera, [{\n    key: \"start\",\n    value: function () {\n      var _start = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var constraints;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                constraints = {\n                  audio: false,\n                  video: {\n                    mandatory: {\n                      sourceId: this.id,\n                      minWidth: 600,\n                      maxWidth: 800,\n                      minAspectRatio: 1.6\n                    },\n                    optional: []\n                  }\n                };\n                _context2.next = 3;\n                return Camera._wrapErrors(\n                /*#__PURE__*/\n                _asyncToGenerator(\n                /*#__PURE__*/\n                regeneratorRuntime.mark(function _callee() {\n                  return regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          _context.next = 2;\n                          return navigator.mediaDevices.getUserMedia(constraints);\n\n                        case 2:\n                          return _context.abrupt(\"return\", _context.sent);\n\n                        case 3:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                })));\n\n              case 3:\n                this._stream = _context2.sent;\n                return _context2.abrupt(\"return\", this._stream);\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function start() {\n        return _start.apply(this, arguments);\n      }\n\n      return start;\n    }()\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      if (!this._stream) {\n        return;\n      }\n\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = _getIterator(this._stream.getVideoTracks()), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var stream = _step.value;\n          stream.stop();\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      this._stream = null;\n    }\n  }], [{\n    key: \"getCameras\",\n    value: function () {\n      var _getCameras = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3() {\n        var devices;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this._ensureAccess();\n\n              case 2:\n                _context3.next = 4;\n                return navigator.mediaDevices.enumerateDevices();\n\n              case 4:\n                devices = _context3.sent;\n                return _context3.abrupt(\"return\", devices.filter(function (d) {\n                  return d.kind === 'videoinput';\n                }).map(function (d) {\n                  return new Camera(d.deviceId, cameraName(d.label));\n                }));\n\n              case 6:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function getCameras() {\n        return _getCameras.apply(this, arguments);\n      }\n\n      return getCameras;\n    }()\n  }, {\n    key: \"_ensureAccess\",\n    value: function () {\n      var _ensureAccess2 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee5() {\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.next = 2;\n                return this._wrapErrors(\n                /*#__PURE__*/\n                _asyncToGenerator(\n                /*#__PURE__*/\n                regeneratorRuntime.mark(function _callee4() {\n                  var access, _iteratorNormalCompletion2, _didIteratorError2, _iteratorError2, _iterator2, _step2, stream;\n\n                  return regeneratorRuntime.wrap(function _callee4$(_context4) {\n                    while (1) {\n                      switch (_context4.prev = _context4.next) {\n                        case 0:\n                          _context4.next = 2;\n                          return navigator.mediaDevices.getUserMedia({\n                            video: true\n                          });\n\n                        case 2:\n                          access = _context4.sent;\n                          _iteratorNormalCompletion2 = true;\n                          _didIteratorError2 = false;\n                          _iteratorError2 = undefined;\n                          _context4.prev = 6;\n\n                          for (_iterator2 = _getIterator(access.getVideoTracks()); !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                            stream = _step2.value;\n                            stream.stop();\n                          }\n\n                          _context4.next = 14;\n                          break;\n\n                        case 10:\n                          _context4.prev = 10;\n                          _context4.t0 = _context4[\"catch\"](6);\n                          _didIteratorError2 = true;\n                          _iteratorError2 = _context4.t0;\n\n                        case 14:\n                          _context4.prev = 14;\n                          _context4.prev = 15;\n\n                          if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n                            _iterator2.return();\n                          }\n\n                        case 17:\n                          _context4.prev = 17;\n\n                          if (!_didIteratorError2) {\n                            _context4.next = 20;\n                            break;\n                          }\n\n                          throw _iteratorError2;\n\n                        case 20:\n                          return _context4.finish(17);\n\n                        case 21:\n                          return _context4.finish(14);\n\n                        case 22:\n                        case \"end\":\n                          return _context4.stop();\n                      }\n                    }\n                  }, _callee4, null, [[6, 10, 14, 22], [15,, 17, 21]]);\n                })));\n\n              case 2:\n                return _context5.abrupt(\"return\", _context5.sent);\n\n              case 3:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function _ensureAccess() {\n        return _ensureAccess2.apply(this, arguments);\n      }\n\n      return _ensureAccess;\n    }()\n  }, {\n    key: \"_wrapErrors\",\n    value: function () {\n      var _wrapErrors2 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee6(fn) {\n        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.prev = 0;\n                _context6.next = 3;\n                return fn();\n\n              case 3:\n                return _context6.abrupt(\"return\", _context6.sent);\n\n              case 6:\n                _context6.prev = 6;\n                _context6.t0 = _context6[\"catch\"](0);\n\n                if (!_context6.t0.name) {\n                  _context6.next = 12;\n                  break;\n                }\n\n                throw new MediaError(_context6.t0.name);\n\n              case 12:\n                throw _context6.t0;\n\n              case 13:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, null, [[0, 6]]);\n      }));\n\n      function _wrapErrors(_x) {\n        return _wrapErrors2.apply(this, arguments);\n      }\n\n      return _wrapErrors;\n    }()\n  }]);\n\n  return Camera;\n}();\n\nmodule.exports = Camera;",{"version":3,"sources":["/srv/http/bekantan-vue-testing/instascan/src/camera.js"],"names":["cameraName","label","clean","replace","MediaError","type","Error","Camera","id","name","_stream","constraints","audio","video","mandatory","sourceId","minWidth","maxWidth","minAspectRatio","optional","_wrapErrors","navigator","mediaDevices","getUserMedia","getVideoTracks","stream","stop","_ensureAccess","enumerateDevices","devices","filter","d","kind","map","deviceId","access","fn","module","exports"],"mappings":"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","sourcesContent":["function cameraName(label) {\n  let clean = label.replace(/\\s*\\([0-9a-f]+(:[0-9a-f]+)?\\)\\s*$/, '');\n  return clean || label || null;\n}\n\nclass MediaError extends Error {\n  constructor(type) {\n    super(`Cannot access video stream (${type}).`);\n    this.type = type;\n  }\n}\n\nclass Camera {\n  constructor(id, name) {\n    this.id = id;\n    this.name = name;\n    this._stream = null;\n  }\n\n  async start() {\n    let constraints = {\n      audio: false,\n      video: {\n        mandatory: {\n          sourceId: this.id,\n          minWidth: 600,\n          maxWidth: 800,\n          minAspectRatio: 1.6\n        },\n        optional: []\n      }\n    };\n\n    this._stream = await Camera._wrapErrors(async () => {\n      return await navigator.mediaDevices.getUserMedia(constraints);\n    });\n\n    return this._stream;\n  }\n\n  stop() {\n    if (!this._stream) {\n      return;\n    }\n\n    for (let stream of this._stream.getVideoTracks()) {\n      stream.stop();\n    }\n\n    this._stream = null;\n  }\n\n  static async getCameras() {\n    await this._ensureAccess();\n\n    let devices = await navigator.mediaDevices.enumerateDevices();\n    return devices\n      .filter(d => d.kind === 'videoinput')\n      .map(d => new Camera(d.deviceId, cameraName(d.label)));\n  }\n\n  static async _ensureAccess() {\n    return await this._wrapErrors(async () => {\n      let access = await navigator.mediaDevices.getUserMedia({ video: true });\n      for (let stream of access.getVideoTracks()) {\n        stream.stop();\n      }\n    });\n  }\n\n  static async _wrapErrors(fn) {\n    try {\n      return await fn();\n    } catch (e) {\n      if (e.name) {\n        throw new MediaError(e.name);\n      } else {\n        throw e;\n      }\n    }\n  }\n}\n\nmodule.exports = Camera;\n"]}]}